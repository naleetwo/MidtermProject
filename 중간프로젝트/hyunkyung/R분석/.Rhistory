data <- read.csv('C:/acorn/midproject/R분석/범죄가격4년치.csv')
View(data)
data <- read.csv('C:/acorn/midproject/R분석/범죄가격4년치.csv', encoding='utf-8')
data <- read.csv('C:/acorn/midproject/R분석/범죄가격4년치.csv', encoding='euc-kr')
data <- read.csv('C:/acorn/midproject/R분석/범죄가격4년치.csv', encoding='cp949')
data <- read.csv('C:/acorn/midproject/R분석/범죄가격4년치.csv', fileEncoding = "UCS-2LE")
data <- read.csv('C:/acorn/midproject/R분석/R범죄가격4년치.csv')
View(data)
data.columns
names(data)
x <- data$crime_num
x
y <- data$X1m.2.전용면적당.거래금액.만원.
cor(x, y, method='pearson')
cor.test(x, y, method = 'pearson')
df <- read.csv('C:/acorn/midproject/R분석/2018범죄가격격.csv')
df <- read.csv('C:/acorn/midproject/R분석/2018범죄가격.csv')
df <- read.csv('C:/acorn/midproject/R분석/R2018범죄가격.csv')
View(df)
x2 <- df$X2018
y2 <- df$X1m.2.전용면적당.거래금액.만원.
cor(x2, y2, method='pearson')
cor.test(x2, y2, method = 'pearson')
cor(x, y, method = 'spearman')
cor(x2, y2, method='spearman')
df <- read.csv('C:/acorn/midproject/analysis/인프라모든요인.csv', fileEncoding='utf-8')
View(df)
df_buy <- as.data.frame(df[, c(4:12)])
View(df_buy)
df_rent <- as.data.frame(df[, c(4:11, 13)])
View(df_rent)
fit <- lm(매매가 ~ ., data=df_buy) # . → 모든 변수를 독립변수로 넣겠다.
summary(fit)
vif(fit)
library(car)
vif(fit)
par(mfrow=c(2, 2))
plot(fit)
shapiro.test(resid(fit))
powerTransform(df_buy$매매가)
summary(powerTransform(states$Murder))
summary(powerTransform(df_buy$매매가))
fit <- lm(log(매매가) ~ ., data=df_buy)
summary(fit)
# forward
full.model <- lm(매매가~., data=df_buy)
# forward
min.model <- lm(매매가~1, data=df_buy)
fwd.model <- step(min.model, direction = 'forward',
scope = (매매가 ~ 범죄건수 + 정류장수 + 편의점수 + 카페수 + 학교수 + 병원수 + 학원수 + 대학교수))
fit <- lm(매매가 ~ ., data=df_buy) # . → 모든 변수를 독립변수로 넣겠다.
summary(fit)
# all subset regression
leap <- regsubsets(매매가 ~ 범죄건수+정류장수+편의점수+카페수+학교수+병원수+학원수+대학교수, data=df_buy, nbest=8)
library(dplyr)
# all subset regression
leap <- regsubsets(매매가 ~ 범죄건수+정류장수+편의점수+카페수+학교수+병원수+학원수+대학교수, data=df_buy, nbest=8)
library(car)
library(dplyr)
library(ggplot2)
# all subset regression
leap <- regsubsets(매매가 ~ 범죄건수+정류장수+편의점수+카페수+학교수+병원수+학원수+대학교수, data=df_buy, nbest=8)
library(leaps)
# all subset regression
leap <- regsubsets(매매가 ~ 범죄건수+정류장수+편의점수+카페수+학교수+병원수+학원수+대학교수, data=df_buy, nbest=8)
leap
par(mfrow=c(1, 1))
plot(leap, scale = 'adjr2')
reg2 <- lm(매매가~카페수+학교수+학원수, data=df_buy)
summary(reg2)
reg3 <- lm(매매가~카페수+학원수, data=df_buy)
summary(reg3)
# 정규성
shapiro.test(resid(reg3)) # 정규분포 아님 0.0001742
powerTransform(mydata$birth_rate) # -1.056671
powerTransform(df_buy$매매가) # -1.056671
summary(powerTransform(df_buy$매매가))
reg4 <- lm(매매가^(-0.27)~카페수+학원수, data=df_buy)
summary(reg4)
shapiro.test(resid(reg4))
# 다중 공선성
vif(reg4)
# 등분산성
ncvTest(reg4)
spreadLevelPlot(reg4)
reg5 <- lm(매매가^(-0.27)^(-0.24)~카페수+학원수, data=df_buy)
summary(reg5)
reg5 <- lm((매매가^(-0.27))^(-0.24)~카페수+학원수, data=df_buy)
summary(reg5)
ncvTest(reg5)
### 4월 27일
vardf = read.csv('C:/acorn/midproject/analysis/인프라모든요인.csv', fileEncoding = 'utf-8')
View(vardf)
bartlett.test(매매가~범죄건수, data=vardf)
### 4월 27일
df = read.csv('C:/acorn/midproject/analysis/인프라모든요인.csv', fileEncoding = 'utf-8')
View(vardf)
### 4월 27일
year_all = read.csv('C:/acorn/midproject/analysis/인프라모든요인.csv', fileEncoding = 'utf-8')
View(year_all)
year_all <- year_all[-1]
View(year_all)
shapiro.test(year_all$카페수수) # 6.675e-12 정규분포가 아니다
shapiro.test(year_all$카페수) # 6.675e-12 정규분포가 아니다
str(year_all)
cor.test(year_all$카페수, year_all$매매가가, method="spearman") #0.5561565
cor.test(year_all$카페수, year_all$매매가, method="spearman") #0.5561565
shapiro.test(year_all$범죄건수) # 1.088e-10 정규분포가 아니다
cor.test(year_all$범죄건수, year_all$매매가, method="spearman") #0.5561565
shapiro.test(year_all$정류장수) # 6.675e-12 정규분포가 아니다
cor.test(year_all$정류장수, year_all$매매가, method="spearman") #0.5566785
shapiro.test(year_all$병원수) # 0.3077 정규분포가 아니다
cor.test(year_all$병원수, year_all$매매가, method="spearman") # 0.0351831
cor.test(year_all$정류장수, year_all$매매가, method="pearson") # 0.0351831
shapiro.test(year_all$병원수) # 8.553e-15 정규분포가 아니다
cor.test(year_all$병원수, year_all$매매가, method="spearman") # 0.0351831
shapiro.test(year_all$학원수) # 8.553e-15 정규분포가 아니다
cor.test(year_all$학원수, year_all$매매가, method="spearman") #
shapiro.test(year_all$대학교수) # 3.062e-12 정규분포가 아니다
cor.test(year_all$학원수, year_all$매매가, method="spearman") #
cor.test(year_all$대학교수, year_all$매매가, method="spearman") # 0.3118478
cor.test(year_all$범죄건수, year_all$전월세가, method="spearman") #
cor.test(year_all$정류장수, year_all$전월세가, method="pearson") # 0.1359168
cor.test(year_all$병원수, year_all$전월세가, method="spearman") #
cor.test(year_all$학원수, year_all$전월세가, method="spearman") #
cor.test(year_all$대학교수, year_all$전월세가, method="spearman") #
par(mfcol=c(2, 5))
plot(year_all$범죄건수, year_all$매매가)
trade_crime <- lm(매매가~범죄건수, data=year_all)
abline(trade_crime, col="blue")
plot(year_all$범죄건수, year_all$전월세가)
rent_crime <- lm(전월세가~범죄건수, data=year_all)
abline(rent_crime, col="blue")
plot(year_all$정류장수, year_all$매매가)
trade_bus <- lm(매매가~정류장수, data=year_all)
abline(trade_bus, col="blue")
plot(year_all$정류장수, year_all$전월세가)
rent_bus <- lm(전월세가~정류장수, data=year_all)
abline(rent_bus, col="blue")
plot(year_all$병원수, year_all$매매가)
trade_hos <- lm(매매가~병원수, data=year_all)
abline(trade_hos, col="blue")
plot(year_all$병원수, year_all$전월세가)
rent_hos <- lm(전월세가~병원수, data=year_all)
abline(rent_hos, col="blue")
plot(year_all$학원수, year_all$매매가)
trade_aca <- lm(매매가~학원수, data=year_all)
abline(trade_aca, col="blue")
plot(year_all$학원수, year_all$전월세가)
rent_aca <- lm(전월세가~학원수, data=year_all)
abline(rent_aca, col="blue")
plot(year_all$대학교수, year_all$매매가)
trade_uni <- lm(매매가~대학교수, data=year_all)
abline(trade_uni, col="blue")
plot(year_all$대학교수, year_all$전월세가)
rent_uni <- lm(전월세가~대학교수, data=year_all)
abline(rent_uni, col="blue")
par(mfcol=c(3, 4))
plot(year_all$범죄건수, year_all$매매가)
trade_crime <- lm(매매가~범죄건수, data=year_all)
abline(trade_crime, col="blue")
plot(year_all$범죄건수, year_all$전월세가)
rent_crime <- lm(전월세가~범죄건수, data=year_all)
abline(rent_crime, col="blue")
plot(year_all$정류장수, year_all$매매가)
trade_bus <- lm(매매가~정류장수, data=year_all)
abline(trade_bus, col="blue")
plot(year_all$정류장수, year_all$전월세가)
rent_bus <- lm(전월세가~정류장수, data=year_all)
abline(rent_bus, col="blue")
plot(year_all$병원수, year_all$매매가)
trade_hos <- lm(매매가~병원수, data=year_all)
abline(trade_hos, col="blue")
plot(year_all$병원수, year_all$전월세가)
rent_hos <- lm(전월세가~병원수, data=year_all)
abline(rent_hos, col="blue")
plot(year_all$학원수, year_all$매매가)
trade_aca <- lm(매매가~학원수, data=year_all)
abline(trade_aca, col="blue")
plot(year_all$학원수, year_all$전월세가)
rent_aca <- lm(전월세가~학원수, data=year_all)
abline(rent_aca, col="blue")
plot(year_all$대학교수, year_all$매매가)
trade_uni <- lm(매매가~대학교수, data=year_all)
abline(trade_uni, col="blue")
plot(year_all$대학교수, year_all$전월세가)
rent_uni <- lm(전월세가~대학교수, data=year_all)
abline(rent_uni, col="blue")
par(mfrow=c(3, 4))
plot(year_all$범죄건수, year_all$매매가)
trade_crime <- lm(매매가~범죄건수, data=year_all)
abline(trade_crime, col="blue")
plot(year_all$범죄건수, year_all$전월세가)
rent_crime <- lm(전월세가~범죄건수, data=year_all)
abline(rent_crime, col="blue")
plot(year_all$정류장수, year_all$매매가)
trade_bus <- lm(매매가~정류장수, data=year_all)
abline(trade_bus, col="blue")
plot(year_all$정류장수, year_all$전월세가)
rent_bus <- lm(전월세가~정류장수, data=year_all)
abline(rent_bus, col="blue")
plot(year_all$병원수, year_all$매매가)
trade_hos <- lm(매매가~병원수, data=year_all)
abline(trade_hos, col="blue")
plot(year_all$병원수, year_all$전월세가)
rent_hos <- lm(전월세가~병원수, data=year_all)
abline(rent_hos, col="blue")
plot(year_all$학원수, year_all$매매가)
trade_aca <- lm(매매가~학원수, data=year_all)
abline(trade_aca, col="blue")
plot(year_all$학원수, year_all$전월세가)
rent_aca <- lm(전월세가~학원수, data=year_all)
abline(rent_aca, col="blue")
plot(year_all$대학교수, year_all$매매가)
trade_uni <- lm(매매가~대학교수, data=year_all)
abline(trade_uni, col="blue")
plot(year_all$대학교수, year_all$전월세가)
rent_uni <- lm(전월세가~대학교수, data=year_all)
abline(rent_uni, col="blue")
par(mfcol=c(5, 2))
plot(year_all$범죄건수, year_all$매매가)
trade_crime <- lm(매매가~범죄건수, data=year_all)
abline(trade_crime, col="blue")
plot(year_all$범죄건수, year_all$전월세가)
rent_crime <- lm(전월세가~범죄건수, data=year_all)
abline(rent_crime, col="blue")
plot(year_all$정류장수, year_all$매매가)
trade_bus <- lm(매매가~정류장수, data=year_all)
abline(trade_bus, col="blue")
plot(year_all$정류장수, year_all$전월세가)
rent_bus <- lm(전월세가~정류장수, data=year_all)
abline(rent_bus, col="blue")
plot(year_all$병원수, year_all$매매가)
trade_hos <- lm(매매가~병원수, data=year_all)
abline(trade_hos, col="blue")
plot(year_all$병원수, year_all$전월세가)
rent_hos <- lm(전월세가~병원수, data=year_all)
abline(rent_hos, col="blue")
plot(year_all$학원수, year_all$매매가)
trade_aca <- lm(매매가~학원수, data=year_all)
abline(trade_aca, col="blue")
plot(year_all$학원수, year_all$전월세가)
rent_aca <- lm(전월세가~학원수, data=year_all)
abline(rent_aca, col="blue")
plot(year_all$대학교수, year_all$매매가)
trade_uni <- lm(매매가~대학교수, data=year_all)
abline(trade_uni, col="blue")
plot(year_all$대학교수, year_all$전월세가)
rent_uni <- lm(전월세가~대학교수, data=year_all)
abline(rent_uni, col="blue")
par(mfcol=c(2, 5))
plot(year_all$범죄건수, year_all$매매가)
trade_crime <- lm(매매가~범죄건수, data=year_all)
abline(trade_crime, col="blue")
plot(year_all$범죄건수, year_all$전월세가)
rent_crime <- lm(전월세가~범죄건수, data=year_all)
abline(rent_crime, col="blue")
plot(year_all$정류장수, year_all$매매가)
trade_bus <- lm(매매가~정류장수, data=year_all)
abline(trade_bus, col="blue")
plot(year_all$정류장수, year_all$전월세가)
rent_bus <- lm(전월세가~정류장수, data=year_all)
abline(rent_bus, col="blue")
plot(year_all$병원수, year_all$매매가)
trade_hos <- lm(매매가~병원수, data=year_all)
abline(trade_hos, col="blue")
plot(year_all$병원수, year_all$전월세가)
rent_hos <- lm(전월세가~병원수, data=year_all)
abline(rent_hos, col="blue")
plot(year_all$학원수, year_all$매매가)
trade_aca <- lm(매매가~학원수, data=year_all)
abline(trade_aca, col="blue")
plot(year_all$학원수, year_all$전월세가)
rent_aca <- lm(전월세가~학원수, data=year_all)
abline(rent_aca, col="blue")
plot(year_all$대학교수, year_all$매매가)
trade_uni <- lm(매매가~대학교수, data=year_all)
abline(trade_uni, col="blue")
plot(year_all$대학교수, year_all$전월세가)
rent_uni <- lm(전월세가~대학교수, data=year_all)
abline(rent_uni, col="blue")
library(ggplot2)
